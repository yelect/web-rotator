<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Electra Map Rotator – No External JS</title>

  <!-- 1. Early connections -->
  <link rel="dns-prefetch" href="https://backend.go-electra.com">
  <link rel="preconnect"   href="https://backend.go-electra.com" crossorigin>

  <!-- 2. Preload the map HTML document -->
  <link rel="preload"
        href="https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e"
        as="document">

  <!-- 3. Preload static bundles (update with actual names from DevTools) -->
  <link rel="preload"
        href="https://backend.go-electra.com/packs/js/904-11acb475713a3c354b63.js"
        as="script">
  <link rel="preload"
        href="https://backend.go-electra.com/packs/js/tv-43ca84669d193ff95164.js"
        as="script">

  <style>
    html, body {
      margin: 0;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    button {
      font-size: 2em;
      padding: 1em 2em;
    }
    .preload {
      width: 1px;
      height: 1px;
      border: none;
      position: absolute;
      left: -9999px;
    }
  </style>
</head>
<body>

  <button id="start">Start Rotator</button>

  <!-- Hidden iframes to keep the map runtime and tiles warm -->
  <div id="map-preloads">
    <iframe class="preload"
            src="https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e"
            aria-hidden="true"></iframe>
    <iframe class="preload"
            src="https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e"
            aria-hidden="true"></iframe>
    <iframe class="preload"
            src="https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e"
            aria-hidden="true"></iframe>
  </div>

<script>
(function(){
  const mapUrl = 'https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e';
  const sites = [
    mapUrl,
    'https://docs.google.com/presentation/d/e/2PACX-1vRbkf5uiF8hV0MDI3vxdCelaiIRFaWLWTzH91U0Sls2ydZ84zr---I47v1GYfKdUzOg-tluTfDD-VYH/pub?start=true&loop=true&delayms=30000',
    'https://my.tikee.io/projects/232996/timelapse/private_share/49d374a7-a9ac-4c29-91f2-5833a4e8c1ec',
    'https://www.google.com/maps/d/u/0/embed?mid=1fG8w2nxBmiQkhlgSxykH8RwQMaeBVb0&ehbc=2E312F&ll=46.840997703251794%2C8.190445841796858&z=8'
    'https://docs.google.com/presentation/d/e/2PACX-1vRjOAXI4N27Lud4-HxzPdFbZh5U9xWKjkmtAQvorDv7rz8GXOgWhvmJTctPAl3MubBNfXa_Nkp2qpSB/pub?start=true&loop=true&delayms=7000',
  ];
  // Set dwell times: 120s for mapUrl, 60s for others (in milliseconds)
  const dwells = sites.map(url => url === mapUrl ? 120000 : 60000);

  let idx = 0, win, timeoutId;

  function rotate() {
    if (win && !win.closed) {
      win.location.href = sites[idx];
      // schedule next rotation based on dwell for the new idx
      timeoutId = setTimeout(rotate, dwells[idx]);
      idx = (idx + 1) % sites.length;
    }
  }

  document.getElementById('start').onclick = function(){
    win = window.open(sites[0], '_blank');
    idx = 1;
    this.disabled = true;
    this.textContent = 'Running…';
    timeoutId = setTimeout(rotate, dwells[0]);
  };
})();
</script>
</body>
</html>
