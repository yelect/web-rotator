<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Electra Map Rotator – No External JS</title>

<!-- 1. Early connections -->
<link rel="dns-prefetch" href="https://backend.go-electra.com">
<link rel="preconnect" href="https://backend.go-electra.com" crossorigin>

<!-- 2. Preload the map HTML document -->
<link rel="preload"
href="https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e"
as="document">

<!-- 3. Preload static bundles (update with actual names from DevTools) -->
<link rel="preload"
href="https://backend.go-electra.com/packs/js/904-11acb475713a3c354b63.js"
as="script">
<link rel="preload"
href="https://backend.go-electra.com/packs/js/tv-43ca84669d193ff95164.js"
as="script">

<style>
html, body {
margin: 0;
height: 100%;
display: flex;
align-items: center;
justify-content: center;
overflow: hidden;
}
button {
font-size: 2em;
padding: 1em 2em;
}
.preload {
width: 1px;
height: 1px;
border: none;
position: absolute;
left: -9999px;
}
</style>
</head>
<body>

<button id="start">Start Rotator</button>

<!-- Hidden iframes to keep the map runtime and tiles warm -->
<div id="map-preloads">
<iframe class="preload"
src="https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e"
aria-hidden="true"></iframe>
<iframe class="preload"
src="https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e"
aria-hidden="true"></iframe>
<iframe class="preload"
src="https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e"
aria-hidden="true"></iframe>
</div>

<script>
(function(){
const mapUrl = 'https://backend.go-electra.com/tv/map?loc=alpine&token=dd0417ad0ab021cc37716848ba0b44e';
const sites = [
mapUrl,
//'https://electra.embed-omniapp.co/dashboards/369c6868?prefersDark=system&f--spot_with_connectors_.country=%7B%22values%22%3A%5B%22CH%22%5D%7D',
//'https://electra.embed-omniapp.co/dashboards/1c9ce22b',
'https://docs.google.com/presentation/d/e/2PACX-1vRbkf5uiF8hV0MDI3vxdCelaiIRFaWLWTzH91U0Sls2ydZ84zr---I47v1GYfKdUzOg-tluTfDD-VYH/pub?start=true&loop=true&delayms=30000',
'https://my.tikee.io/projects/247207/timelapse/private_share/072f04d6-1a22-4af0-ac19-31cffc1e5cd6', //Mystop aussen
'https://my.tikee.io/projects/251460/timelapse/private_share/57233865-505c-4a2c-9081-d2d054fb8ed7', //Mystop A4
'https://my.tikee.io/projects/251436/timelapse/private_share/9769fb93-92f5-4b34-b893-967a4b08d6be', //Wädi wösch
'https://my.tikee.io/projects/251434/timelapse/private_share/44410ac6-99cb-4604-ba0c-c1ce4a2e85d2', //Rubigen
'https://www.google.com/maps/d/u/0/embed?mid=1fG8w2nxBmiQkhlgSxykH8RwQMaeBVb0&ehbc=2E312F&ll=46.840997703251794%2C8.190445841796858&z=8',
'https://docs.google.com/presentation/d/e/2PACX-1vRjOAXI4N27Lud4-HxzPdFbZh5U9xWKjkmtAQvorDv7rz8GXOgWhvmJTctPAl3MubBNfXa_Nkp2qpSB/pub?start=true&loop=true&delayms=10000'
];
const dwell = 60000; // 60 seconds
let idx = 0, win;

document.getElementById('start').onclick = function(){
win = window.open(sites[0], '_blank'); // opens map first
idx = 1; // next will be sites[1]
this.disabled = true;
this.textContent = 'Running…';

// First rotation waits 120s because we start on the map
const firstDelay = dwell * 2;

setTimeout(() => {
setInterval(() => {
if (win && !win.closed) {
win.location.href = sites[idx];
idx = (idx + 1) % sites.length;
// Skip the map URL if we encounter it during rotation
if (sites[idx] === mapUrl) {
idx = (idx + 1) % sites.length;
}
}
}, dwell);
}, firstDelay);
};
})();
</script>
</body>
</html>
